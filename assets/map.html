<body>
  <div id="filter-box">
    â­ â‰¥ <input id="minRating" type="number" step="0.1" value="0">
    ğŸ“ â‰¥ <input id="minReview" type="number" value="0">
    <button onclick="applyFilter()">ì ìš©</button>
  </div>

  <div id="map"></div>
</body>

<style>
* {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

#map {
  width: 100%;
  height: 100%;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

#filter-box {
  position: absolute;
  top: 10px;
  left: 10px;
  background: white;
  padding: 10px 12px;
  z-index: 9999;
  border-radius: 6px;
  font-size: 13px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  pointer-events: auto;
}

#filter-box input,
#filter-box button {
  -webkit-user-select: text;
  -moz-user-select: text;
  user-select: text;
  pointer-events: auto;
}

#filter-box button {
  margin-left: 5px;
  padding: 4px 10px;
  background: #4CAF50;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

#filter-box input {
  width: 50px;
  padding: 2px 4px;
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 0 5px;
}

.marker-label {
  background: white;
  padding: 4px;
  font-size: 11px;
  border-radius: 4px;
  text-align: center;
}
</style>

<script>
let map;
let markers = [];
let overlays = [];

function drawMarkers(stores) {
  clearAll();

  stores.forEach(store => {
    const position = new kakao.maps.LatLng(store.lat, store.lng);

    const marker = new kakao.maps.Marker({ position });
    marker.setMap(map);
    markers.push(marker);

    const overlay = new kakao.maps.CustomOverlay({
      position,
      content: `
        <div class="marker-label">
          <b>${store.name}</b><br/>
          â­ ${store.rating ?? 0} Â· ğŸ“ ${store.reviewCount ?? 0}
        </div>
      `,
      yAnchor: 1.6
    });
    overlay.setMap(map);
    overlays.push(overlay);

    kakao.maps.event.addListener(marker, 'click', () => {
      alert(`${store.name}\nâ­ ${store.rating}\nğŸ“ ${store.reviewCount}`);
    });
  });
}

function clearAll() {
  markers.forEach(m => m.setMap(null));
  overlays.forEach(o => o.setMap(null));
  markers = [];
  overlays = [];
}

function applyFilter() {
  const minRating = document.getElementById('minRating').value;
  const minReview = document.getElementById('minReview').value;

  window.flutter_inappwebview
    ? null
    : console.log("Flutter ì—°ë™ ì˜ˆì •");
}
</script>
